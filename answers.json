[
    {
        "id": 1,
        "question": "查询年级为 2001 的所有学生的名称，按编号升序排列。",
        "sql": "SELECT sname FROM STUDENTS WHERE grade = 2001 ORDER BY sid ASC;"
    },
    {
        "id": 2,
        "question": "查询学生的选课成绩合格的课程成绩，并把成绩换算为绩点(60 分对应绩点为 1,每增加 1 分，绩点增加 0.1)。",
        "sql": "SELECT score, 1 + (score - 60) * 0.1 as gpa FROM CHOICES WHERE score >= 60;"
    },
    {
        "id": 3,
        "question": "查询课时是 48 或 64 的课程的名称。",
        "sql": "SELECT cname FROM COURSES WHERE hour IN (48, 64);"
    },
    {
        "id": 4,
        "question": "查询所有课程名称中含有 data 的课程编号。",
        "sql": "SELECT cid FROM COURSES WHERE cname LIKE '%data%';"
    },
    {
        "id": 5,
        "question": "查询所有选课记录的课程号(不重复显示)。",
        "sql": "SELECT DISTINCT cid FROM CHOICES;"
    },
    {
        "id": 6,
        "question": "统计所有老师的平均工资。",
        "sql": "SELECT AVG(salary) FROM TEACHERS;"
    },
    {
        "id": 7,
        "question": "查询所有学生的编号，姓名和平均成绩，按总平均成绩降序排列。",
        "sql": "SELECT s.sid, s.sname, AVG(c.score) as avg_score FROM STUDENTS s JOIN CHOICES c ON s.sid = c.sid GROUP BY s.sid, s.sname ORDER BY avg_score DESC;"
    },
    {
        "id": 8,
        "question": "统计各个课程的选课人数和平均成绩。",
        "sql": "SELECT cid, COUNT(sid) as student_count, AVG(score) as avg_score FROM CHOICES GROUP BY cid;"
    },
    {
        "id": 9,
        "question": "查询至少选修了三门课程的学生编号。",
        "sql": "SELECT sid FROM CHOICES GROUP BY sid HAVING COUNT(cid) >= 3;"
    },
    {
        "id": 10,
        "question": "查询全部课程的详细记录",
        "sql": "SELECT * FROM COURSES;"
    },
    {
        "id": 11,
        "question": "查询所有有选修课的学生的编号",
        "sql": "SELECT DISTINCT sid FROM CHOICES;"
    },
    {
        "id": 12,
        "question": "查询课时<88(小时)的课程的编号",
        "sql": "SELECT cid FROM COURSES WHERE hour < 88;"
    },
    {
        "id": 13,
        "question": "请找出总分超过 400 分的学生",
        "sql": "SELECT sid FROM CHOICES GROUP BY sid HAVING SUM(score) > 400;"
    },
    {
        "id": 14,
        "question": "查询课程的总数",
        "sql": "SELECT COUNT(*) FROM COURSES;"
    },
    {
        "id": 15,
        "question": "查询所有课程和选修该课程的学生总数",
        "sql": "SELECT c.cname, COUNT(ch.sid) FROM COURSES c LEFT JOIN CHOICES ch ON c.cid = ch.cid GROUP BY c.cid, c.cname;"
    },
    {
        "id": 16,
        "question": "查询选修成绩合格的课程超过两门的学生编号。",
        "sql": "SELECT sid FROM CHOICES WHERE score >= 60 GROUP BY sid HAVING COUNT(cid) > 2;"
    },
    {
        "id": 17,
        "question": "统计各个学生的选修课程数目和平均成绩",
        "sql": "SELECT sid, COUNT(cid) as course_count, AVG(score) as avg_score FROM CHOICES GROUP BY sid;"
    },
    {
        "id": 18,
        "question": "查询所有选课记录的成绩并将其换算为五分制(满分为5分，合格为3分),注意SCORE取NULL值的情况。",
        "sql": "SELECT score, score / 20.0 as five_point FROM CHOICES;"
    },
    {
        "id": 19,
        "question": "查询选修编号为10028的课程的学生的人数，其中成绩合格的学生人数，不合格的学生人数，讨论NULL值的特殊含义。",
        "sql": "SELECT COUNT(*) as total, SUM(CASE WHEN score >= 60 THEN 1 ELSE 0 END) as pass_count, SUM(CASE WHEN score < 60 THEN 1 ELSE 0 END) as fail_count FROM CHOICES WHERE cid = '10028';"
    },
    {
        "id": 20,
        "question": "通过实验检验在使用ORDER BY进行排序时，取NULL的项是否出现在结果中?如果有，在什么位置?",
        "sql": "SELECT * FROM CHOICES ORDER BY score;"
    },
    {
        "id": 21,
        "question": "在上面的查询的过程中如果加上保留字DISTINCT会有什么效果呢?",
        "sql": "SELECT DISTINCT * FROM CHOICES ORDER BY score;"
    },
    {
        "id": 22,
        "question": "通过实验说明使用分组GROUP BY对取值为NULL的项的处理。",
        "sql": "SELECT score, COUNT(*) FROM CHOICES GROUP BY score;"
    },
    {
        "id": 23,
        "question": "结合分组，使用集合函数求每个同学的平均分，总的选课记录，最高成绩，最低成绩，总成绩。",
        "sql": "SELECT sid, AVG(score), COUNT(cid), MAX(score), MIN(score), SUM(score) FROM CHOICES GROUP BY sid;"
    },
    {
        "id": 24,
        "question": "查询成绩小于0的选课记录，统计总数，平均分，最大值和最小值。",
        "sql": "SELECT COUNT(*), AVG(score), MAX(score), MIN(score) FROM CHOICES WHERE score < 0;"
    },
    {
        "id": 25,
        "question": "查询所有课程记录的上课学时(数据库中为每星期学时),以一学期十八个星期计算每个课程的总学时，注意HOUR取NULL值的情况。",
        "sql": "SELECT cname, hour * 18 as total_hour FROM COURSES;"
    },
    {
        "id": 26,
        "question": "通过查询选修课程C++的学生的人数，其中成绩合格的学生人数，不合格的学生人数，讨论NULL值的特殊含义。",
        "sql": "SELECT COUNT(*) as total, SUM(CASE WHEN score >= 60 THEN 1 ELSE 0 END) as pass, SUM(CASE WHEN score < 60 THEN 1 ELSE 0 END) as fail FROM CHOICES ch JOIN COURSES c ON ch.cid = c.cid WHERE c.cname = 'c++';"
    },
    {
        "id": 27,
        "question": "查询选修课程C++的学生的编号和成绩，使用ORDER BY按成绩进行排序时，取NULL的项是否出现在结果中?如果有，在什么位置?",
        "sql": "SELECT ch.sid, ch.score FROM CHOICES ch JOIN COURSES c ON ch.cid = c.cid WHERE c.cname = 'c++' ORDER BY ch.score;"
    },
    {
        "id": 28,
        "question": "在上面的查询的过程中，如果加上保留字DISTINCT会有什么效果呢?",
        "sql": "SELECT DISTINCT ch.sid, ch.score FROM CHOICES ch JOIN COURSES c ON ch.cid = c.cid WHERE c.cname = 'c++' ORDER BY ch.score;"
    },
    {
        "id": 29,
        "question": "按年级对所有的学生进行分组，能得到多少个组?与现实的情况有什么不同?",
        "sql": "SELECT grade, COUNT(*) FROM STUDENTS GROUP BY grade;"
    },
    {
        "id": 30,
        "question": "结合分组，使用集合函数求每个课程选修的学生的平均分，总的选课记录数，最高成绩，最低成绩，讨论考察取空值的项对集合函数的作用的影响。",
        "sql": "SELECT cid, AVG(score), COUNT(sid), MAX(score), MIN(score) FROM CHOICES GROUP BY cid;"
    },
    {
        "id": 31,
        "question": "查询学号850955252的学生同年级的所有学生资料",
        "sql": "SELECT * FROM STUDENTS WHERE grade = (SELECT grade FROM STUDENTS WHERE sid = '850955252');"
    },
    {
        "id": 32,
        "question": "查询所有的有选课的学生的详细信息（显示前100条）",
        "sql": "SELECT s.* FROM STUDENTS s WHERE EXISTS (SELECT 1 FROM CHOICES c WHERE c.sid = s.sid) LIMIT 100;"
    },
    {
        "id": 33,
        "question": "查询没有学生选的课程的编号",
        "sql": "SELECT cid FROM COURSES WHERE cid NOT IN (SELECT DISTINCT cid FROM CHOICES);"
    },
    {
        "id": 34,
        "question": "查询选修了课程名为C++的学生学号和姓名",
        "sql": "SELECT s.sid, s.sname FROM STUDENTS s JOIN CHOICES ch ON s.sid = ch.sid JOIN COURSES c ON ch.cid = c.cid WHERE c.cname = 'c++';"
    },
    {
        "id": 35,
        "question": "找出选修课程成绩最差的选课记录。",
        "sql": "SELECT * FROM CHOICES WHERE score = (SELECT MIN(score) FROM CHOICES);"
    },
    {
        "id": 36,
        "question": "找出和课程UML或课程C++的课时一样的课程名称",
        "sql": "SELECT cname FROM COURSES WHERE hour = (SELECT hour FROM COURSES WHERE cname = 'uml') OR hour = (SELECT hour FROM COURSES WHERE cname = 'c++');"
    },
    {
        "id": 37,
        "question": "查询所有选修编号10001的课程的学生的姓名",
        "sql": "SELECT s.sname FROM STUDENTS s JOIN CHOICES c ON s.sid = c.sid WHERE c.cid = '10001';"
    },
    {
        "id": 38,
        "question": "查询选修了所有课程的学生姓名。",
        "sql": "SELECT s.sname FROM STUDENTS s JOIN CHOICES c ON s.sid = c.sid GROUP BY s.sid, s.sname HAVING COUNT(DISTINCT c.cid) = (SELECT COUNT(*) FROM COURSES);"
    },
    {
        "id": 39,
        "question": "查询选修C++课程的成绩比姓名为znkoo的学生高的所有学生的编号和姓名",
        "sql": "SELECT distinct s.sid, s.sname FROM STUDENTS s JOIN CHOICES c ON s.sid = c.sid JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'c++' AND c.score > (SELECT c2.score FROM CHOICES c2 JOIN STUDENTS s2 ON c2.sid = s2.sid JOIN COURSES co2 ON c2.cid = co2.cid WHERE s2.sname = 'znkoo' AND co2.cname = 'c++');"
    },
    {
        "id": 40,
        "question": "找出和学生883794999或学生850955252的年级一样的学生的姓名",
        "sql": "SELECT sname FROM STUDENTS WHERE grade IN (SELECT grade FROM STUDENTS WHERE sid IN ('883794999', '850955252'));"
    },
    {
        "id": 41,
        "question": "查询没有选修Java的学生名称",
        "sql": "SELECT sname FROM STUDENTS WHERE sid NOT IN (SELECT c.sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'java');"
    },
    {
        "id": 42,
        "question": "找出课时最少的课程的详细信息",
        "sql": "SELECT * FROM COURSES WHERE hour = (SELECT MIN(hour) FROM COURSES);"
    },
    {
        "id": 43,
        "question": "查询工资最高的教师的编号和开设的课程号",
        "sql": "SELECT t.tid, c.cid FROM TEACHERS t JOIN CHOICES c ON t.tid = c.tid WHERE t.salary = (SELECT MAX(salary) FROM TEACHERS);"
    },
    {
        "id": 44,
        "question": "找出选修课程ERP成绩最高的学生编号",
        "sql": "SELECT sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'erp' ORDER BY score DESC LIMIT 1;"
    },
    {
        "id": 45,
        "question": "查询没有学生选修的课程的名称",
        "sql": "SELECT cname FROM COURSES WHERE cid NOT IN (SELECT cid FROM CHOICES);"
    },
    {
        "id": 46,
        "question": "找出讲授课程UML的教师讲授的所有课程名称",
        "sql": "SELECT DISTINCT co.cname FROM COURSES co JOIN CHOICES c ON co.cid = c.cid WHERE c.tid IN (SELECT DISTINCT c2.tid FROM CHOICES c2 JOIN COURSES co2 ON c2.cid = co2.cid WHERE co2.cname = 'uml');"
    },
    {
        "id": 47,
        "question": "查询选修了编号200102901的教师开设的所有课程的学生编号",
        "sql": "SELECT DISTINCT sid FROM CHOICES WHERE tid = '200102901';"
    },
    {
        "id": 48,
        "question": "查询选修课程Database的学生集合与选修课程UML的学生集合的并集",
        "sql": "SELECT sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'database' UNION SELECT sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'uml';"
    },
    {
        "id": 49,
        "question": "查询编号800009026的学生所选的全部课程的课程名和成绩",
        "sql": "SELECT co.cname, c.score FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE c.sid = '800009026';"
    },
    {
        "id": 50,
        "question": "查询所有选了database的学生的编号",
        "sql": "SELECT c.sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'database';"
    },
    {
        "id": 51,
        "question": "求出选择了同一个课程的学生对",
        "sql": "SELECT a.sid AS sid1, b.sid AS sid2, a.cid FROM CHOICES a JOIN CHOICES b ON a.cid = b.cid WHERE a.sid < b.sid;"
    },
    {
        "id": 52,
        "question": "求出至少被两名学生选修的课程编号",
        "sql": "SELECT cid FROM CHOICES GROUP BY cid HAVING COUNT(sid) >= 2;"
    },
    {
        "id": 53,
        "question": "查询选修了编号850955252的学生所选的某个课程的学生编号",
        "sql": "SELECT sid FROM CHOICES WHERE cid IN (SELECT cid FROM CHOICES WHERE sid = '850955252');"
    },
    {
        "id": 54,
        "question": "查询学生的基本信息及选修课程编号和成绩",
        "sql": "SELECT s.*, c.cid, c.score FROM STUDENTS s JOIN CHOICES c ON s.sid = c.sid;"
    },
    {
        "id": 55,
        "question": "查询学号850955252的学生的姓名和选修的课程名称及成绩",
        "sql": "SELECT s.sname, co.cname, c.score FROM STUDENTS s JOIN CHOICES c ON s.sid = c.sid JOIN COURSES co ON c.cid = co.cid WHERE s.sid = '850955252';"
    },
    {
        "id": 56,
        "question": "利用集合运算，查询选修课程C++或课程Java的学生的编号",
        "sql": "SELECT sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'c++' OR co.cname = 'java';"
    },
    {
        "id": 57,
        "question": "实现集合交运算，查询既选修课程C++又选修课程Java的学生的编号",
        "sql": "SELECT sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'c++' INTERSECT SELECT sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'java';"
    },
    {
        "id": 58,
        "question": "实现集合减运算，查询选修课程C++而没有选修课程Java的学生的编号",
        "sql": "SELECT sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'c++' EXCEPT SELECT sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'java';"
    },
    {
        "id": 59,
        "question": "查询选修Java的所有学生的编号及姓名",
        "sql": "SELECT s.sid, s.sname FROM STUDENTS s JOIN CHOICES c ON s.sid = c.sid JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'java';"
    },
    {
        "id": 60,
        "question": "分别使用等值连接和谓词IN两种方式查询姓名为sssht的学生所选的课程的编号和成绩",
        "sql": "SELECT c.cid, c.score FROM CHOICES c JOIN STUDENTS s ON c.sid = s.sid WHERE s.sname = 'sssht';"
    },
    {
        "id": 61,
        "question": "查询其他课时比课程C++多的课程的名称",
        "sql": "SELECT cname FROM COURSES WHERE hour > (SELECT hour FROM COURSES WHERE cname = 'c++');"
    },
    {
        "id": 62,
        "question": "实现集合交运算，查询既选修课程Database又选修课程UML的学生的编号",
        "sql": "SELECT sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'database' INTERSECT SELECT sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'uml';"
    },
    {
        "id": 63,
        "question": "实现集合减运算，查询选修课程Database而没有选修课程UML的学生的编号",
        "sql": "SELECT sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'database' EXCEPT SELECT sid FROM CHOICES c JOIN COURSES co ON c.cid = co.cid WHERE co.cname = 'uml';"
    }
]